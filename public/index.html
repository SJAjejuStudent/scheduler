<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Scheduler</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f4f4f4; }
        .container { width: 50%; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0px 0px 10px gray; }
        input, select, button { margin: 10px; padding: 8px; width: 80%; }
        button { background: blue; color: white; border: none; cursor: pointer; }
        button:hover { background: darkblue; }
        #scheduleOutput { text-align: left; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>AI Study Scheduler</h2>
       
        <h3>Add School Subjects</h3>
        <input type="text" id="subjectName" placeholder="Enter subject">
        <input type="number" id="subjectPriority" placeholder="Priority (1=Most Important)">
        <button onclick="addSubject()">Add Subject</button>

        <h3>Add Assignment</h3>
        <input type="text" id="assignmentName" placeholder="Enter assignment">
        <input type="date" id="dueDate">
        <select id="assignmentType">
            <option value="summative">Summative</option>
            <option value="formative">Formative</option>
        </select>
        <select id="assignmentSubject"></select>
        <button onclick="addAssignment()">Add Assignment</button>

        <h3>Add Extracurricular</h3>
        <input type="text" id="extraName" placeholder="Enter extracurricular">
        <input type="date" id="extraDueDate">
        <button onclick="addExtra()">Add Extracurricular</button>

        <h3>Generated Schedule</h3>
        <button onclick="generateSchedule()">Generate</button>
        <div id="scheduleOutput"></div>
    </div>

    <script>
        let subjects = [];
        let assignments = [];
        let extras = [];

        function addSubject() {
            let name = document.getElementById("subjectName").value.trim();
            let priority = parseInt(document.getElementById("subjectPriority").value);

            if (!name || isNaN(priority)) {
                alert("Please enter a valid subject and priority.");
                return;
            }

            // Prevent duplicates
            if (subjects.some(s => s.name.toLowerCase() === name.toLowerCase())) {
                alert("Subject already exists!");
                return;
            }

            subjects.push({ name, priority });

            let subjectDropdown = document.getElementById("assignmentSubject");
            let option = document.createElement("option");
            option.value = name;
            option.textContent = name;
            subjectDropdown.appendChild(option);
        }

        function addAssignment() {
            let name = document.getElementById("assignmentName").value.trim();
            let dueDate = new Date(document.getElementById("dueDate").value);
            let type = document.getElementById("assignmentType").value;
            let subject = document.getElementById("assignmentSubject").value;
            let subjectPriority = subjects.find(s => s.name === subject)?.priority || 10;
           
            if (!name || !dueDate || !subject) {
                alert("Please enter valid assignment details.");
                return;
            }

            assignments.push({ name, dueDate, type, subject, subjectPriority });
        }

        function addExtra() {
            let name = document.getElementById("extraName").value.trim();
            let dueDate = new Date(document.getElementById("extraDueDate").value);

            if (!name || !dueDate) {
                alert("Please enter a valid extracurricular activity.");
                return;
            }

            // Prevent duplicates
            if (extras.some(e => e.name.toLowerCase() === name.toLowerCase())) {
                alert("Extracurricular activity already exists!");
                return;
            }

            extras.push({ name, dueDate });
        }

        function generateSchedule() {
            let today = new Date();
            let twoWeeks = 14 * 24 * 60 * 60 * 1000;
            let threeDays = 3 * 24 * 60 * 60 * 1000;

            assignments.sort((a, b) => {
                let aTimeLeft = a.dueDate - today;
                let bTimeLeft = b.dueDate - today;

                // Prioritize summative unless it's more than 2 weeks away
                if (a.type === "summative" && b.type !== "summative" && aTimeLeft < twoWeeks) return -1;
                if (b.type === "summative" && a.type !== "summative" && bTimeLeft < twoWeeks) return 1;

                // Prioritize assignments with less than 3 days left
                if (aTimeLeft < threeDays && bTimeLeft >= threeDays) return -1;
                if (bTimeLeft < threeDays && aTimeLeft >= threeDays) return 1;

                // Sort by user-defined priority
                if (a.subjectPriority !== b.subjectPriority) return a.subjectPriority - b.subjectPriority;

                // If same priority, sort by due date
                return aTimeLeft - bTimeLeft;
            });

            let output = "<h3>Final Schedule</h3><ul>";

            assignments.forEach(a => {
                output += `<li><b>${a.name}</b> (${a.type}) - ${a.subject} (Due: ${a.dueDate.toDateString()})</li>`;
            });

            extras.forEach(e => {
                output += `<li><b>${e.name}</b> (Extracurricular) - (Due: ${e.dueDate.toDateString()})</li>`;
            });

            output += "</ul>";
            document.getElementById("scheduleOutput").innerHTML = output;
            
        }
    </script>

</body>
</html>